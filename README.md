# ๐ Tilda + Supabase Auth System

ะกะธััะตะผะฐ ะฐะฒัะพัะธะทะฐัะธะธ ะธ ะพัะพะฑัะฐะถะตะฝะธั ะดะฐะฝะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะดะปั ัะฐะนัะพะฒ ะฝะฐ Tilda ั ะฑะฐะทะพะน ะดะฐะฝะฝัั Supabase.

## ๐ ะะฟะธัะฐะฝะธะต

ะญัะฐ ัะธััะตะผะฐ ะฟะพะทะฒะพะปัะตั:
- โ ะะตัะตัะฒะฐััะฒะฐัั ะฐะฒัะพัะธะทะฐัะธั ะฝะฐ ัะพัะผะฐั Tilda
- โ ะะฒัะพะผะฐัะธัะตัะบะธ ะพัะพะฑัะฐะถะฐัั ะดะฐะฝะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะฐ ัััะฐะฝะธัะฐั
- โ ะกะธะฝััะพะฝะธะทะธัะพะฒะฐัั ัะตััะธะธ ะผะตะถะดั ัััะฐะฝะธัะฐะผะธ
- โ ะะฐะฑะพัะฐัั ะฑะตะท ะธะทะผะตะฝะตะฝะธั ััะฐะฝะดะฐััะฝัั ัะพัะผ Tilda

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Tilda Forms   โโโโโถโ   Node.js API    โโโโโถโ   Supabase DB   โ
โ  (auth-inter.)  โ    โ   (server.js)    โ    โ   (users table) โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
         โ                        โ                        โ
         โผ                        โผ                        โผ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ  Tilda Pages    โโโโโโ  Session Store   โโโโโโ  User Data API  โ
โ (user-display)  โ    โ  (in memory)     โ    โ  (REST calls)   โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
tilda-supabase-server/
โโโ server.js                 # ๐ฅ๏ธ  ะัะฝะพะฒะฝะพะน ัะตัะฒะตั (Node.js + Express)
โโโ auth-interceptor.html     # ๐ ะะพะด ะดะปั ัััะฐะฝะธัั ะฐะฒัะพัะธะทะฐัะธะธ
โโโ user-display.html        # ๐ค ะะพะด ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ะดะฐะฝะฝัั ะฟะพะปัะทะพะฒะฐัะตะปั
โโโ test-auth.html           # ๐งช ะกััะฐะฝะธัะฐ ะดะปั ัะตััะธัะพะฒะฐะฝะธั ัะธััะตะผั
โโโ package.json             # ๐ฆ ะะฐะฒะธัะธะผะพััะธ ะฟัะพะตะบัะฐ
โโโ .env                     # ๐ ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั (Supabase)
โโโ README.md               # ๐ ะะพะบัะผะตะฝัะฐัะธั
```

## ๐ ะัััััะน ััะฐัั

### 1. ะะฐัััะพะนะบะฐ ัะตัะฒะตัะฐ

ะกะตัะฒะตั ัะถะต ัะฐะทะฒะตัะฝัั ะฝะฐ Railway: `https://tilda-supabase-server-nodejs-20.up.railway.app`

### 2. ะะฐัััะพะนะบะฐ ะฐะฒัะพัะธะทะฐัะธะธ

1. **ะกะบะพะฟะธััะนัะต ะบะพะด ะธะท `auth-interceptor.html`**
2. **ะััะฐะฒััะต ะฒ ะฑะปะพะบ T123 ะฝะฐ ัััะฐะฝะธัะต ะฐะฒัะพัะธะทะฐัะธะธ Tilda**
3. **ะะฟัะฑะปะธะบัะนัะต ัััะฐะฝะธัั**

### 3. ะะฐัััะพะนะบะฐ ะพัะพะฑัะฐะถะตะฝะธั ะดะฐะฝะฝัั

1. **ะกะพะทะดะฐะนัะต Zero Block ั ัะปะตะผะตะฝัะฐะผะธ:**
   ```html
   <div class="t-name">ะะผั ะฟะพะปัะทะพะฒะฐัะตะปั</div>
   <div class="t-email">Email ะฟะพะปัะทะพะฒะฐัะตะปั</div>
   <div class="t-phone">ะขะตะปะตัะพะฝ ะฟะพะปัะทะพะฒะฐัะตะปั</div>
   ```

2. **ะกะบะพะฟะธััะนัะต ะบะพะด ะธะท `user-display.html`**
3. **ะััะฐะฒััะต ะฒ ะฑะปะพะบ T123 ะฝะฐ ัััะฐะฝะธัะต ั ะดะฐะฝะฝัะผะธ**
4. **ะะฟัะฑะปะธะบัะนัะต ัััะฐะฝะธัั**

## ๐ฏ API Endpoints

### `POST /auth-sync`
ะกะธะฝััะพะฝะธะทะฐัะธั ะฐะฒัะพัะธะทะฐัะธะธ ะฟะพะปัะทะพะฒะฐัะตะปั
```javascript
{
  "email": "user@example.com",
  "action": "login",
  "timestamp": "2024-01-01T12:00:00Z",
  "source": "tilda_form",
  "page": "https://example.com/login"
}
```

### `GET /current-user`
ะะพะปััะตะฝะธะต ัะตะบััะตะณะพ ะฐะฒัะพัะธะทะพะฒะฐะฝะฝะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
```javascript
{
  "success": true,
  "user": {
    "email": "user@example.com",
    "name": "ะะผั ะะพะปัะทะพะฒะฐัะตะปั",
    "phone": "+996123456789"
  }
}
```

### `GET /get-user?email=user@example.com`
ะะพะปััะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ email
```javascript
{
  "success": true,
  "user": {
    "email": "user@example.com",
    "name": "ะะผั ะะพะปัะทะพะฒะฐัะตะปั",
    "phone": "+996123456789"
  }
}
```

## ๐ง ะะฐัััะพะนะบะฐ ัะปะตะผะตะฝัะพะฒ

ะ ัะฐะนะปะต `user-display.html` ะฝะฐัััะพะนัะต ัะตะปะตะบัะพัั ัะปะตะผะตะฝัะพะฒ:

```javascript
const USER_ELEMENTS = {
    '#rec1235790536 .t-name': 'name',           // ะะผั ะฟะพะปัะทะพะฒะฐัะตะปั
    '#rec1235790536 .t-email': 'email',         // Email ะฟะพะปัะทะพะฒะฐัะตะปั  
    '#rec1235790536 .t-phone': 'phone',         // ะขะตะปะตัะพะฝ ะฟะพะปัะทะพะฒะฐัะตะปั
    '#rec1235790536 .t-company': 'company',     // ะะพะผะฟะฐะฝะธั
    '#rec1235790536 .t-position': 'position',   // ะะพะปะถะฝะพััั
    
    // ะะพะฑะฐะฒััะต ัะฒะพะธ ัะตะปะตะบัะพัั:
    // '.user-name': 'name',
    // '.user-info': 'email',
    // '[data-user="name"]': 'name',
};
```

## ๐งช ะัะปะฐะดะบะฐ

### ะะปั ัััะฐะฝะธัั ะฐะฒัะพัะธะทะฐัะธะธ:
- ะะฐะถะผะธัะต **Ctrl+Shift+A** ะดะปั ะพัะบัััะธั ะพัะปะฐะดะพัะฝะพะน ะฟะฐะฝะตะปะธ
- ะัะฟะพะปัะทัะนัะต ะบะฝะพะฟะบะธ ะดะปั ัะตััะธัะพะฒะฐะฝะธั ะฟะตัะตัะฒะฐัะฐ ัะพัะผ

### ะะปั ัััะฐะฝะธัั ะพัะพะฑัะฐะถะตะฝะธั ะดะฐะฝะฝัั:
- ะะฐะถะผะธัะต **Ctrl+Shift+U** ะดะปั ะพัะบัััะธั ะพัะปะฐะดะพัะฝะพะน ะฟะฐะฝะตะปะธ
- ะัะฟะพะปัะทัะนัะต ะบะฝะพะฟะบะธ ะดะปั ัะตััะธัะพะฒะฐะฝะธั ะทะฐะณััะทะบะธ ะดะฐะฝะฝัั

## ๐๏ธ ะะฐะทะฐ ะดะฐะฝะฝัั

ะกัััะบัััะฐ ัะฐะฑะปะธัั `users` ะฒ Supabase:

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    name VARCHAR(255),
    phone VARCHAR(50),
    company VARCHAR(255),
    position VARCHAR(255),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

## ๐ ะะตะทะพะฟะฐัะฝะพััั

- โ CORS ะฝะฐัััะพะตะฝ ะดะปั ัะฐะฑะพัั ั ะดะพะผะตะฝะฐะผะธ Tilda
- โ ะะฐะปะธะดะฐัะธั email ะฐะดัะตัะพะฒ
- โ ะะฐัะธัะฐ ะพั SQL ะธะฝัะตะบัะธะน ัะตัะตะท Supabase
- โ ะกะตััะธะธ ััะฐะฝัััั ะฒ ะฟะฐะผััะธ ัะตัะฒะตัะฐ (ะฝะต ะฒ cookies)

## ๐จ ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะัะพะฑะปะตะผะฐ: ะะฐะฝะฝัะต ะฝะต ะพัะพะฑัะฐะถะฐัััั
1. ะัะพะฒะตัััะต ัะตะปะตะบัะพัั ะฒ `USER_ELEMENTS`
2. ะฃะฑะตะดะธัะตัั, ััะพ ะฟะพะปัะทะพะฒะฐัะตะปั ะฐะฒัะพัะธะทะพะฒะฐะฝ
3. ะัะบัะพะนัะต ะบะพะฝัะพะปั ะฑัะฐัะทะตัะฐ (F12) ะดะปั ะฟัะพัะผะพััะฐ ะพัะธะฑะพะบ

### ะัะพะฑะปะตะผะฐ: ะะฒัะพัะธะทะฐัะธั ะฝะต ัะฐะฑะพัะฐะตั
1. ะัะพะฒะตัััะต, ััะพ ะบะพะด ะฒััะฐะฒะปะตะฝ ะฒ ะฑะปะพะบ T123
2. ะฃะฑะตะดะธัะตัั, ััะพ ัะพัะผะฐ ะธะผะตะตั ะฟะพะปะต email
3. ะัะพะฒะตัััะต ะบะพะฝัะพะปั ะฑัะฐัะทะตัะฐ ะฝะฐ ะพัะธะฑะบะธ

### ะัะพะฑะปะตะผะฐ: ะกะตัะฒะตั ะฝะตะดะพัััะฟะตะฝ
1. ะัะพะฒะตัััะต ััะฐััั Railway: https://railway.app
2. ะฃะฑะตะดะธัะตัั, ััะพ URL ัะตัะฒะตัะฐ ะบะพััะตะบัะฝัะน
3. ะัะพะฒะตัััะต ะฝะฐัััะพะนะบะธ CORS

## ๐ ะะพะดะดะตัะถะบะฐ

ะะปั ะฟะพะปััะตะฝะธั ะฟะพะผะพัะธ:
1. ะัะบัะพะนัะต ะบะพะฝัะพะปั ะฑัะฐัะทะตัะฐ (F12)
2. ะะฐะนะดะธัะต ัะพะพะฑัะตะฝะธั ั ะฟัะตัะธะบัะฐะผะธ ๐, ๐ค, โ, โ
3. ะัะฟะพะปัะทัะนัะต ะพัะปะฐะดะพัะฝัะต ะฟะฐะฝะตะปะธ (Ctrl+Shift+A/U)

## ๐ ะะฑะฝะพะฒะปะตะฝะธั

ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพะฑะฝะพะฒะปัะตั ะดะฐะฝะฝัะต ะบะฐะถะดัะต 30 ัะตะบัะฝะด ะธ ะฟะพะดะดะตัะถะธะฒะฐะตั:
- โ ะะฒัะพะผะฐัะธัะตัะบะพะต ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต ัะพะตะดะธะฝะตะฝะธั
- โ ะะตัะธัะพะฒะฐะฝะธะต ะดะฐะฝะฝัั ะฟะพะปัะทะพะฒะฐัะตะปั
- โ ะะฝะดะธะบะฐัะพัั ะทะฐะณััะทะบะธ ะธ ะพัะธะฑะพะบ
- โ ะะตัะธะพะดะธัะตัะบัั ัะธะฝััะพะฝะธะทะฐัะธั

---

**ะะตััะธั:** 2.0  
**ะกัะฐััั:** โ ะะพัะพะฒะพ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั  
**ะกะตัะฒะตั:** https://tilda-supabase-server-nodejs-20.up.railway.app